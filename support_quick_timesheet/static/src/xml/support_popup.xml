<templates>
    <t t-name="support_quick_timesheet.SupportPopup" owl="1">
        <div class="o_support_popup" t-att-class="{ 'o_collapsed': state.isCollapsed, 'o_hidden': !state.isVisible }">
            <div class="o_support_header d-flex justify-content-between align-items-center p-2 bg-primary text-white" t-on-click="toggleCollapse">
                <span class="fw-bold"><i class="fa fa-life-ring me-2"/>Quick Support</span>
                <div>
                    <i t-att-class="state.isCollapsed ? 'fa fa-chevron-up' : 'fa fa-chevron-down'" class="me-2 cursor-pointer"/>
                    <i class="fa fa-times cursor-pointer" t-on-click.stop="closePopup"/>
                </div>
            </div>
            
            <div t-if="!state.isCollapsed" class="o_support_content p-3 overflow-auto">
                <div class="mb-3">
                    <label class="form-label small fw-bold">Customer</label>
                    <select class="form-select form-select-sm" t-model="state.partnerId">
                        <option value="">Select Customer...</option>
                        <t t-foreach="data.partners" t-as="p" t-key="p.id">
                            <option t-att-value="p.id"><t t-esc="p.display_name"/></option>
                        </t>
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label small fw-bold">Support Type</label>
                    <select class="form-select form-select-sm" t-model="state.typeId">
                        <option value="">Select Type...</option>
                        <t t-foreach="data.types" t-as="t" t-key="t.id">
                            <option t-att-value="t.id"><t t-esc="t.name"/></option>
                        </t>
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label small fw-bold">Contact Person</label>
                    <input type="text" class="form-control form-control-sm" placeholder="Name..." t-model="state.contactPerson"/>
                </div>

                <div class="o_support_slots d-flex flex-wrap gap-2 pt-2 border-top">
                    <t t-foreach="data.slots" t-as="s" t-key="s.id">
                        <button class="btn btn-outline-primary btn-sm flex-fill" 
                                t-on-click="() => this.createTimesheet(s.id)"
                                t-att-disabled="state.isProcessing">
                            <t t-esc="s.name"/>
                        </button>
                    </t>
                </div>
            </div>
        </div>

        <div t-if="!state.isVisible" class="o_support_launcher position-fixed bottom-0 end-0 m-3 btn btn-primary rounded-circle shadow d-flex align-items-center justify-content-center" style="width: 50px; height: 50px; z-index: 1040;" t-on-click="openPopup">
            <i class="fa fa-life-ring fa-2x"/>
        </div>
    </t>

    <t t-name="support_quick_timesheet.OpenSupportPopupAction" owl="1">
        <div class="d-none">Opening Support...</div>
    </t>
</templates>
